{"flowContents":{"identifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b","instanceIdentifier":"00d98a57-0196-1000-0bc5-18c1e618d36b","name":"exceltojson","comments":"","position":{"x":1072.0,"y":-64.0},"processGroups":[],"remoteProcessGroups":[],"processors":[{"identifier":"d069f1b4-47d0-3c82-8a36-2a0b6a4b5639","instanceIdentifier":"00e028cb-0196-1000-ea7b-94a7d458b570","name":"ExecuteScript","comments":"","position":{"x":144.0,"y":-136.0},"type":"org.apache.nifi.processors.script.ExecuteScript","bundle":{"group":"org.apache.nifi","artifact":"nifi-scripting-nar","version":"2.2.0"},"properties":{"Script File":null,"Script Engine":"Groovy","Script Body":"@Grab(group='org.apache.poi', module='poi-ooxml', version='5.2.3')\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook\nimport groovy.json.JsonOutput\nimport java.nio.charset.StandardCharsets\n\ndef flowFile = session.get()\nif (!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def workbook = new XSSFWorkbook(inputStream)\n    def sheet = workbook.getSheetAt(0)\n\n    def headers = []\n    def dataList = []\n\n    sheet.eachWithIndex { row, rowIndex ->\n        if (rowIndex == 0) {\n            row.each { cell -> headers << cell.toString() }\n        } else {\n            def rowData = [:]\n            row.eachWithIndex { cell, i ->\n                rowData[headers[i]] = cell.toString()\n            }\n            dataList << rowData\n        }\n    }\n\n    def json = JsonOutput.prettyPrint(JsonOutput.toJson(dataList))\n    outputStream.write(json.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)","Module Directory":null},"propertyDescriptors":{"Script File":{"name":"Script File","displayName":"Script File","identifiesControllerService":false,"sensitive":false,"dynamic":false,"resourceDefinition":{"cardinality":"SINGLE","resourceTypes":["FILE"]}},"Script Engine":{"name":"Script Engine","displayName":"Script Engine","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Script Body":{"name":"Script Body","displayName":"Script Body","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Module Directory":{"name":"Module Directory","displayName":"Module Directory","identifiesControllerService":false,"sensitive":false,"dynamic":false,"resourceDefinition":{"cardinality":"MULTIPLE","resourceTypes":["FILE","DIRECTORY"]}}},"style":{},"schedulingPeriod":"0 sec","schedulingStrategy":"TIMER_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":["failure"],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b"},{"identifier":"c2e1b3ef-e8fb-3201-85d5-2c7d0016284e","instanceIdentifier":"00e1ca12-0196-1000-4c63-3a4198763501","name":"PutFile","comments":"","position":{"x":-104.0,"y":48.0},"type":"org.apache.nifi.processors.standard.PutFile","bundle":{"group":"org.apache.nifi","artifact":"nifi-standard-nar","version":"2.2.0"},"properties":{"Group":null,"Owner":null,"Create Missing Directories":"true","Permissions":null,"Maximum File Count":null,"Last Modified Time":null,"Directory":"D:\\nifiOutput","Conflict Resolution Strategy":"fail"},"propertyDescriptors":{"Group":{"name":"Group","displayName":"Group","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Owner":{"name":"Owner","displayName":"Owner","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Create Missing Directories":{"name":"Create Missing Directories","displayName":"Create Missing Directories","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Permissions":{"name":"Permissions","displayName":"Permissions","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Maximum File Count":{"name":"Maximum File Count","displayName":"Maximum File Count","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Last Modified Time":{"name":"Last Modified Time","displayName":"Last Modified Time","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Directory":{"name":"Directory","displayName":"Directory","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Conflict Resolution Strategy":{"name":"Conflict Resolution Strategy","displayName":"Conflict Resolution Strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false}},"style":{},"schedulingPeriod":"0 sec","schedulingStrategy":"TIMER_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":["success","failure"],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b"},{"identifier":"ea625ee5-78ad-3580-825e-1d2f47bd464d","instanceIdentifier":"00de1325-0196-1000-715a-969ed376fcd3","name":"GetFile","comments":"","position":{"x":-280.0,"y":-144.0},"type":"org.apache.nifi.processors.standard.GetFile","bundle":{"group":"org.apache.nifi","artifact":"nifi-standard-nar","version":"2.2.0"},"properties":{"Keep Source File":"false","Minimum File Age":"0 sec","Polling Interval":"0 sec","Input Directory":"D:\\nifiInput","Maximum File Age":null,"Batch Size":"10","Maximum File Size":null,"Minimum File Size":"0 B","Ignore Hidden Files":"true","Recurse Subdirectories":"true","File Filter":".*\\.xlsx","Path Filter":null},"propertyDescriptors":{"Keep Source File":{"name":"Keep Source File","displayName":"Keep Source File","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Minimum File Age":{"name":"Minimum File Age","displayName":"Minimum File Age","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Polling Interval":{"name":"Polling Interval","displayName":"Polling Interval","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Input Directory":{"name":"Input Directory","displayName":"Input Directory","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Maximum File Age":{"name":"Maximum File Age","displayName":"Maximum File Age","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Batch Size":{"name":"Batch Size","displayName":"Batch Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Maximum File Size":{"name":"Maximum File Size","displayName":"Maximum File Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Minimum File Size":{"name":"Minimum File Size","displayName":"Minimum File Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Ignore Hidden Files":{"name":"Ignore Hidden Files","displayName":"Ignore Hidden Files","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Recurse Subdirectories":{"name":"Recurse Subdirectories","displayName":"Recurse Subdirectories","identifiesControllerService":false,"sensitive":false,"dynamic":false},"File Filter":{"name":"File Filter","displayName":"File Filter","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Path Filter":{"name":"Path Filter","displayName":"Path Filter","identifiesControllerService":false,"sensitive":false,"dynamic":false}},"style":{},"schedulingPeriod":"0 sec","schedulingStrategy":"TIMER_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":[],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b"}],"inputPorts":[],"outputPorts":[],"connections":[{"identifier":"7db910cc-4a46-321f-8b11-2579c4c70aa3","instanceIdentifier":"00e28cbc-0196-1000-62ff-20b025a964ca","name":"","source":{"id":"d069f1b4-47d0-3c82-8a36-2a0b6a4b5639","type":"PROCESSOR","groupId":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b","name":"ExecuteScript","comments":"","instanceIdentifier":"00e028cb-0196-1000-ea7b-94a7d458b570"},"destination":{"id":"c2e1b3ef-e8fb-3201-85d5-2c7d0016284e","type":"PROCESSOR","groupId":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b","name":"PutFile","comments":"","instanceIdentifier":"00e1ca12-0196-1000-4c63-3a4198763501"},"labelIndex":0,"zIndex":0,"selectedRelationships":["success"],"backPressureObjectThreshold":10000,"backPressureDataSizeThreshold":"1 GB","flowFileExpiration":"0 sec","prioritizers":[],"bends":[],"loadBalanceStrategy":"DO_NOT_LOAD_BALANCE","partitioningAttribute":"","loadBalanceCompression":"DO_NOT_COMPRESS","componentType":"CONNECTION","groupIdentifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b"},{"identifier":"f3dd0a8d-730f-3204-8f87-a017a83cf895","instanceIdentifier":"00e26e0c-0196-1000-6d7c-2721573de45b","name":"","source":{"id":"ea625ee5-78ad-3580-825e-1d2f47bd464d","type":"PROCESSOR","groupId":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b","name":"GetFile","comments":"","instanceIdentifier":"00de1325-0196-1000-715a-969ed376fcd3"},"destination":{"id":"d069f1b4-47d0-3c82-8a36-2a0b6a4b5639","type":"PROCESSOR","groupId":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b","name":"ExecuteScript","comments":"","instanceIdentifier":"00e028cb-0196-1000-ea7b-94a7d458b570"},"labelIndex":0,"zIndex":0,"selectedRelationships":["success"],"backPressureObjectThreshold":10000,"backPressureDataSizeThreshold":"1 GB","flowFileExpiration":"0 sec","prioritizers":[],"bends":[],"loadBalanceStrategy":"DO_NOT_LOAD_BALANCE","partitioningAttribute":"","loadBalanceCompression":"DO_NOT_COMPRESS","componentType":"CONNECTION","groupIdentifier":"205f4e1e-2303-3ea5-a223-6d5a07a86a0b"}],"labels":[],"funnels":[],"controllerServices":[],"defaultFlowFileExpiration":"0 sec","defaultBackPressureObjectThreshold":10000,"defaultBackPressureDataSizeThreshold":"1 GB","scheduledState":"ENABLED","executionEngine":"INHERITED","maxConcurrentTasks":1,"statelessFlowTimeout":"1 min","componentType":"PROCESS_GROUP","flowFileConcurrency":"UNBOUNDED","flowFileOutboundPolicy":"STREAM_WHEN_AVAILABLE"},"externalControllerServices":{},"parameterContexts":{},"flowEncodingVersion":"1.0","parameterProviders":{},"latest":false}